{
    "lds": [ "<b>Local Dicom Service</b><br><br>",
              "The logs can be found in /var/log/PACS/LocalDicomService"
            ],
    "ifp": [ "<b>Incoming File Processor</b>",
	      "<br><br>",
              "The incoming file processor will select all SOP's for a study and will handle the study to the Incoming Filw Worker (IFW). This is an internal LDS process.",
              "<br><br>",
              "<b>Log file:</b><br><br>",
              "LocalDicomService_INCOMINGFILES.log"
             ],
     "ifw0": [ "<b>Incoming File Worker</b>",
               "<br><br>",
               "Handles the work during image ingestion. There are multiple IFW threads.<br><br>",
              "<b>Log files:</b><br><br>",
              "LocalDicomService_IFW*.log"
              ],
     "pending": [ "This is the first stage on image reception.<br><br>",
                   "During this stage LDS checks if there has been global deletion for the series/study<br>",
                   "If there was a global deletion, LDS evaluates the AssociationEpochInSecs and compare it to the deletion time.  If the AssociationEpochInSecs is < Deletion time we will discard the image.  If not LDS will continue onto the next state<br><br>",
                   "<b>Log snippet:</b><br><br>",
                   "Processing 6 incoming files in the range (3956909,3956914) for status=PENDING<br>",
                   "--> Start: 1.3.12.2.1107.5.5.2.112186.4.0.20708479328063227 (timer PENDING)<br>",
                   "<-- Elapsed: 0.0 sec: 1.3.12.2.1107.5.5.2.112186.4.0.20708479328063227 (timer PENDING)<br>",
                   "<br><br>",
                   "<b>Status in the database before this step: </b> PENDING",
                   "<br><br>",
                   "<b>Status in the database after this step: </b> IN_PROGRESS",
                   "<br><br>",
                   "<b>Database query:</b>select count(*),status from incoming_files where series_uid = '1.3.12.2.1107.5.5.2.112186.4.0.20708479328063227' group by 2,3;"],
    "initial": [ "At this step LDS will generate the initial study/series checkpoints<br><br>", 
                  "<b>Log snippet:</b><br><br>",
                  "Processing 6 incoming files in the range (3956909,3956914) for status=IN_PROGRESS<br>",
                  "--> Start: 1.3.12.2.1107.5.5.2.112186.4.0.20708479328063227 (timer IN_PROGRESS)<br>",
                  ". . . <br>",
                  "Inserting an Initial Correction. [com.intelerad.localdicomservice.model.DicomModification@1ac3093[<br>",
                  "mDicomModificationId=337-11-1--1<br>",
		  "mRequestedDatetimeAsEpoch=1462378685730<br>",
		  "mTarget=1.3.12.2.1107.5.5.2.112186.4.0.20708478832311392<br>",
		  "mType=STUDY_CORRECTION<br>",
		  "mChanges=[Tag={(3f01,0005) Private Creator Data Element.}=PLEXMISIAHMOD1]<br>",
		  "mNonTagAttrs={7=INITIAL}<br>",
	          "mStatus=PENDING<br>",
                  "mLogger=com.intelerad.localdicomservice.common.DefaultLog@1a906d4<br>",
		  "mNumExecutions=0<br>",
		  "mGenerationId=509<br>",
   	          "mDatabaseId=<null>",
		  "Stored correction: com.intelerad.localdicomservice.model.DicomModification@1fabc57[<br>", 
		  "mDicomModificationId=337-11-1-374812<br>", 
  		  "mRequestedDatetimeAsEpoch=1462378685730<br>", 
		  "mTarget=1.3.12.2.1107.5.5.2.112186.4.0.20708478832311392<br>", 
		  "mType=SERIES_CHECKPOINT_CORRECTION<br>", 
		  "mChanges=[Tag={(0008,0060) Modality.}=US, Tag={(0020,0011) Series Number.}=1, Tag={(3f01,0003) Private Creator Data Element.}=US1KTN, Tag={(0008,0021) Series Date.}=Wed May 04 00:00:00 CDT 2016, Tag={(0008,0031) Series Time.}=Thu Jan 01 12:13:22 CST 1970]<br>", 
		  "mNonTagAttrs={1=1.3.12.2.1107.5.5.2.112186.4.0.20708479328063227}<br>", 
		  "mStatus=DONE<br>", 
		  "mLogger=com.intelerad.localdicomservice.common.DefaultLog@63345e<br>", 
		  "mNumExecutions=0<br>", 
		  "mGenerationId=508<br>", 
		  "mDatabaseId=1154657<br>", 
		  "Elapsed: 0.035 sec: 1.3.12.2.1107.5.5.2.112186.4.0.20708479328063227 (timer IN_PROGRESS)<br>",
                  "<br><br>", 
		  "<b>Status in the database before this step: </b> IN_PROGESS",
                  "<br><br>",
                  "<b>Status in the database after this step: </b> VALIDATION",
                  "<br><br>",
                  "<b>Database query:</b>select count(*),status from incoming_files where series_uid = '1.3.12.2.1107.5.5.2.112186.4.0.20708479328063227' group by 2,3;"
                  ],
    "validate": [ "LDS performs the VALIDATION<br><br>",
                  "<b>Log snippet:</b><br><br>",                
  		  "Processing 6 incoming files in the range (3956909,3956914) for status=VALIDATE",
		  "--> Start: 1.3.12.2.1107.5.5.2.112186.4.0.20708479328063227 (timer VALIDATE)<br>", 
		  "VALIDATION_MODE=[IMMEDIATE]<br>", 
		  "calling RIS validation program: [/usr/local/tools/LocalDicomService/ldsValidate, --log-file=/var/log/PACS/LocalDicomService/LocalDicomService_IFW_0.log, --result-file=/tmp/valresp4004344307190542244.tmp]<br>", 
		  ". . . <br>", 
		  "********************* Starting Validation *********************    <br>", 
		  "(loadValidationAlgorithmConfiguration) loaded query algorithm 'AccessionNumber'<br>", 
		  ". . .<br>", 
		  "(loadValidationAlgorithmConfiguration) loaded query algorithm 'AccessionNumberPostFix'<br>", 
		  "(cleanupMissingKeys) missing key RIS_USE_QUERY_BY_DATE is not mandatory since key RIS_QUERY_LIST is provided<br>", 
		  "(cleanupMissingKeys) RIS_USE_QUERY_BY_DATE removed from the list of missing keys<br>", 
		  "(cleanupMissingKeys) missing key RIS_USE_QUERY_BY_PATIENT_ID is not mandatory since key RIS_QUERY_LIST is provided<br>", 
		  "(cleanupMissingKeys) RIS_USE_QUERY_BY_PATIENT_ID removed from the list of missing keys<br>", 
		  "StudyInstanceUID=[1.3.12.2.1107.5.5.2.112186.4.0.20708478832311392]<br>", 
		  " . . . <br>",
		  "Query sent successfully<br>", 
		  "Calling receiveResponse()<br>", 
		  "--> HL7_QUERY_RECEIVING_6369 Setting profile.<br>", 
		  " . . . <br>",
		  "Successful validation! Recording data returned by the RIS for use in generating a correction<br>", 
		  "Replacing study description with [US DUPLEX VNS EXT UNLT/LMTD STDY(93971)] derived from order<br>", 
		  "This AE (US1KTN) has 0 HL7->DICOM mapping(s) configured.<br>", 
		  "Automatic validation succeeded.<br>", 
		  "Study [1.3.12.2.1107.5.5.2.112186.4.0.20708478832311392] now has status [RIS_UPDATE_NOT_SENT]<br>", 
		  "[ *********** Validation finished [no errors] **********    <br>", 
		  ". . . <br>", 
		  "validation result: ValidationResultXfer  **** blanked out the data ***<br>", 
		  "validation took 0.2894 seconds from parent's perspective<br>", 
		  "Stored correction: com.intelerad.localdicomservice.model.DicomModification@16d74da[<br>", 
		  "mDicomModificationId=337-11-1-374814<br>", 
		  "mRequestedDatetimeAsEpoch=1462378686059<br>", 
		  "mTarget=1.3.12.2.1107.5.5.2.112186.4.0.20708478832311392<br>", 
		  "mType=STUDY_CORRECTION<br>", 
		  "mChanges=[Tag={(0010,0010) Patient's Name.}= ****<br>", 
		  "mNonTagAttrs={5=301286MIS, 7=VALIDATION}<br>", 
		  "mStatus=PENDING<br>", 
		  "mLogger=com.intelerad.localdicomservice.common.DefaultLog@1129f33<br>", 
		  "mNumExecutions=0<br>", 
		  "mGenerationId=510<br>", 
		  "mDatabaseId=1154659<br>", 
		  "<-- Elapsed: 0.302 sec: 1.3.12.2.1107.5.5.2.112186.4.0.20708479328063227 (timer VALIDATE)<br>",
                 "<br><br>",
                  "<b>Status in the database before this step: </b> VALIDATION",
                  "<br><br>",
                  "<b>Status in the database after this step: </b> VERSION0",
                  "<br><br>",
                  "<b>Database query:</b>select count(*),status from where series_uid = '1.3.12.2.1107.5.5.2.112186.4.0.20708479328063227' group by 2,3;"
                 ],
    "version0": [ "LDS copies the files from the temporary location to the final path in version 0 folder, inserts into sop/sop_todo table for j2c conversion, updates imageSeriesHeader.ish.",
                  "<br><br>",
                  "<b>Log snippet:</b><br><br>",
		  "Processing 6 incoming files in the range (3956909,3956914) for status=VERSION0<br>",
		  "--> Start: 1.3.12.2.1107.5.5.2.112186.4.0.20708479328063227 (timer VERSION0)<br>",
		  "There are no .ish file(s) in [/usr/local/PACS/images/20160504/1.3.12.2.1107.5.5.2.112186.4.0.20708478832311392/1.3.12.2.1107.5.5.2.112186.4.0.20708479328063227-v/0] - skipping concatenation and series header creation<br>",
		  "<-- Elapsed: 0.0060 sec: 1.3.12.2.1107.5.5.2.112186.4.0.20708479328063227 (timer VERSION0)<br>",
                  "<br><br>",
                  "<b>Status in the database before this step: </b> VERSION0",
                  "<br><br>",
                  "<b>Status in the database after this step: </b> VERSION1",
                  "<br><br>",
                  "<b>Database query:</b>select count(*),status from incoming_files where series_uid = '1.3.12.2.1107.5.5.2.112186.4.0.20708479328063227' group by 2,3;"

              ],


    "version1": [ "LDS creates version 1 folder, creates the hardlinks between the versioning, appends the image header ish files, performs all DONE corrections.<br><br>",
                "<b>Log snippet:</b><br><br>",
                "Processing 6 incoming files in the range (3956909,3956914) for status=VERSION1<br>",
                "--> Start: 1.3.12.2.1107.5.5.2.112186.4.0.20708479328063227 (timer VERSION1)<br>",
                "Linking immutable 0-version files into latest version [1]<br>",
                "Starting reading file: /usr/local/PACS/images/tmp/incoming_files/20160504/1118/1.3.12.2.1107.5.5.2.112186.4.0.20712525432003175/1/1.3.12.2.1107.5.5.2.112186.4.0.20712525432003175.dcm<br>",
                "padding=32<br>",
                "len=8<br>",
                "Modified time tag [Tag={(0008,0030) Study Time.}], replacing initial value [121321.859000] with new value [121321.859]<br>",
                "Modified time tag [Tag={(0008,0031) Series Time.}], replacing initial value [121322.000000] with new value [121322.000]<br>",
                "OriginalTagCount=[163], tags read=[163]<br>",
                "Linking immutable 0-version files into latest version [1]<br>",
                "Starting reading file: /usr/local/PACS/images/tmp/incoming_files/20160504/1118/1.3.12.2.1107.5.5.2.112186.4.0.20712523622445513/1/1.3.12.2.1107.5.5.2.112186.4.0.20712523622445513.dcm<br>",
                "Modified time tag [Tag={(0008,0030) Study Time.}], replacing initial value [121321.859000] with new value [121321.859]<br>",
                "Modified time tag [Tag={(0008,0031) Series Time.}], replacing initial value [121322.000000] with new value [121322.000]<br>",
                "OriginalTagCount=[191], tags read=[191]<br>",
                "Linking immutable 0-version files into latest version [1]<br>",
                "Starting reading file: /usr/local/PACS/images/tmp/incoming_files/20160504/1118/1.3.12.2.1107.5.5.2.112186.4.0.20712521926882222/1/1.3.12.2.1107.5.5.2.112186.4.0.20712521926882222.dcm<br>",
                "Modified time tag [Tag={(0008,0030) Study Time.}], replacing initial value [121321.859000] with new value [121321.859]<br>",
                "Modified time tag [Tag={(0008,0031) Series Time.}], replacing initial value [121322.000000] with new value [121322.000]<br>",
                "OriginalTagCount=[163], tags read=[163]<br>",
                "Linking immutable 0-version files into latest version [1]<br>",
                "Starting reading file: /usr/local/PACS/images/tmp/incoming_files/20160504/1118/1.3.12.2.1107.5.5.2.112186.4.0.2071252024612713/1/1.3.12.2.1107.5.5.2.112186.4.0.2071252024612713.dcm<br>",
                "Modified time tag [Tag={(0008,0030) Study Time.}], replacing initial value [121321.859000] with new value [121321.859]<br>",
                "Modified time tag [Tag={(0008,0031) Series Time.}], replacing initial value [121322.000000] with new value [121322.000]<br>",
                "OriginalTagCount=[152], tags read=[152]<br>",
                "Linking immutable 0-version files into latest version [1]<br>",
                "Starting reading file: /usr/local/PACS/images/tmp/incoming_files/20160504/1118/1.3.12.2.1107.5.5.2.112186.4.0.20712517931792141/1/1.3.12.2.1107.5.5.2.112186.4.0.20712517931792141.dcm<br>",
                "Modified time tag [Tag={(0008,0030) Study Time.}], replacing initial value [121321.859000] with new value [121321.859]<br>",
                "Modified time tag [Tag={(0008,0031) Series Time.}], replacing initial value [121322.000000] with new value [121322.000]<br>",
                "OriginalTagCount=[152], tags read=[152]<br>",
                "Linking immutable 0-version files into latest version [1]<br>",
                "There are no .ish file(s) in [/usr/local/PACS/images/20160504/1.3.12.2.1107.5.5.2.112186.4.0.20708478832311392/1.3.12.2.1107.5.5.2.112186.4.0.20708479328063227-v/1] - skipping concatenation and series header creation<br>",
                "Regenerating nonImageSeriesHeader.ish in [/usr/local/PACS/images/20160504/1.3.12.2.1107.5.5.2.112186.4.0.20708478832311392/1.3.12.2.1107.5.5.2.112186.4.0.20708479328063227-v/1]<br>",
                "About to invoke ldsRegenerateSeriesHeader using: CommandLauncher[ '/usr/local/tools/LocalDicomService/ldsRegenerateSeriesHeader' '-n' '-u' 'i_am_not_a_human_being_running_this_by_hand_or_in_a_script_because_if_that_were_the_case_id_use_manageLds_like_i_am_supposed_to' '/usr/local/PACS/images/20160504/1.3.12.2.1107.5.5.2.112186.4.0.20708478832311392/1.3.12.2.1107.5.5.2.112186.4.0.20708479328063227-v/1' ] WorkingDirectory = /usr/local/PACS/images/20160504/1.3.12.2.1107.5.5.2.112186.4.0.20708478832311392/1.3.12.2.1107.5.5.2.112186.4.0.20708479328063227-v/1<br>",
                "<-- Elapsed: 0.052 sec: 1.3.12.2.1107.5.5.2.112186.4.0.20708479328063227 (timer VERSION1)",
                 "<br><br>",
                 "<b>Status in the database before this step: </b> VERSION1",
                 "<br><br>",
                 "<b>Status in the database after this step: </b> DICOMIMAGE",
                 "<br><br>",
                 "<b>Database query:</b>select count(*),status from incoming files where series_uid = '1.3.12.2.1107.5.5.2.112186.4.0.20708479328063227' group by 2,3;"
                  ],
    "dicomimage": [ "LDS inserts the series/study information in DicomImage.If validation passed LDS inserts DICOM Prefetch events into DicomImage..ImageEventQueue ",
                  "<br><br>",
                  "<b>Log snippet:</b><br><br>",
                "Processing 6 incoming files in the range (3956909,3956914) for status=DICOMIMAGE<br>", 
                "--> Start: 1.3.12.2.1107.5.5.2.112186.4.0.20708479328063227 (timer DICOMIMAGE)<br>", 
                "Inserting into DicomImage<br>", 
                "Submit task [insertIntoDicomImage] to queue [DicomImageDatabaseQueueExecutor]. Queue size is [0]<br>", 
                "--> Start: ImageInsertion (timer ImageInsertion)<br>", 
                "Updating patId=[301286MIS] with +NumPatRelStu=[1], +NumPatRelSer=[1], +NumPatRelIma=[6], [database=DicomImageStandardSql{mMapping=com.intelerad.localdicomservice.databasequeues.DicomImage2DataModel@d98810getConnection()=Db Connection from Threadcom.intelerad.localdicomservice.databasequeues.DicomImageDatabaseQueueto DicomImage@plexmisiahmod1.plexus created at Tue May 03 15:00:57 CDT 2016}]<br>", 
                "Inserting Study into DicomImage. [database=DicomImageStandardSql{mMapping=com.intelerad.localdicomservice.databasequeues.DicomImage2DataModel@d98810getConnection()=Db Connection from Threadcom.intelerad.localdicomservice.databasequeues.DicomImageDatabaseQueue to DicomImage@plexmisiahmod1.plexus created at Tue May 03 15:00:57 CDT 2016}],[study=com.intelerad.localdicomservice.model.StudyLevel@d27029[<br>", 
                "  mStudyDateTime=20160504121321.859-0500<br>", 
                "  mAccessionNumber=00755663MIS<br>", 
                "  mImsPostFix=MIS<br>", 
                "  mStudyID=2<br>", 
                "  mStudyInstanceUID=1.3.12.2.1107.5.5.2.112186.4.0.20708478832311392<br>", 
                "  mReferringPhysician=com.intelerad.dicommasterservice.lib.ReferringPhysician@515bda[<br>", 
                "  mId=<br>", 
                "  mName=BRADY^JOHN^<br>", 
                "]<br>", 
                "  mDescription=US DUPLEX VNS EXT UNLT/LMTD STDY(93971)<br>", 
                "  mPatientAge=066Y<br>", 
                "  mPatientSize=<null><br>", 
                "  mPatWei=<null><br>", 
                "  mNumStuRelIma=0<br>", 
                "  mNumStuRelSer=0<br>", 
                "  mInsertDateTime=<null><br>", 
                "  mOwner=PLEXMISIAHMOD1<br>", 
                "  mGroupName=STONIONIS^MARY^A<br>", 
                "  mPriv=US<br>", 
                "  mPatientParent=301286MIS<br>", 
                "  mPatientHistory=<null><br>", 
                "  mOrganization=MIS<br>", 
                "  mRequestedProcedureId=1<br>", 
                "  mDateTimeUtils=com.intelerad.localdicomservice.common.DateTimeUtilsImpl@26c088<br>", 
                "  mIsPrefetchQueued=true<br>", 
                "  mLastImageReceivedAsEpoch=Optional.of(1462378685614)<br>", 
                "  mBlankAssigned=[PAT_SIZE, PAT_WEIGHT, PAT_HISTORY]<br>", 
                "]]<br>", 
                "Inserting Series into DicomImage. [database=DicomImageStandardSql{mMapping=com.intelerad.localdicomservice.databasequeues.DicomImage2DataModel@d98810getConnection()=Db Connection from Threadcom.intelerad.localdicomservice.databasequeues.DicomImageDatabaseQueue to DicomImage@plexmisiahmod1.plexus created at Tue May 03 15:00:57 CDT 2016}],[series=com.intelerad.localdicomservice.model.SeriesLevel@1c1b4fe[<br>", 
                "  mBodyPartExamined=<null><br>", 
                "  mModality=US<br>", 
                "  mNumberOfImages=0<br>", 
                "  mSeriesDate=20160504<br>", 
                "  mSeriesTime=121322<br>", 
                "  mSeriesDescription=<null><br>", 
                "  mSeriesInstanceUid=1.3.12.2.1107.5.5.2.112186.4.0.20708479328063227<br>", 
                "  mSeriesNumber=1<br>", 
                "  mViewPosition=<null><br>", 
                "  mStudyInstanceUid=1.3.12.2.1107.5.5.2.112186.4.0.20708478832311392<br>", 
                "  mOwner=PLEXMISIAHMOD1<br>", 
                "  mSourceAe=US1KTN<br>", 
                "  mSeriesPath=/usr/local/PACS/images/20160504/1.3.12.2.1107.5.5.2.112186.4.0.20708478832311392/1.3.12.2.1107.5.5.2.112186.4.0.20708479328063227<br>", 
                "  mScheduledProcedureStepId=1<br>", 
                "  mCallingAe=US1KTN<br>", 
                "  mCalledAe=PLEXMISIAHMOD1<br>", 
                "  mMaxAssociationTime=Optional.of(1462378683000)<br>", 
                "  mInsertDateTime=<null><br>", 
                "Inserting Series instance [SeriesInstance [mSerInsUid=1.3.12.2.1107.5.5.2.112186.4.0.20708479328063227, mStorageType=directory, mStorageBin=0, mTimeStampInserted=Wed May 04 11:18:06 CDT 2016,mTimeStampMru=Wed May 04 11:18:06 CDT 2016],SeriesInstance [mSerInsUid=1.3.12.2.1107.5.5.2.112186.4.0.20708479328063227, mStorageType=pxl, mStorageBin=-1, mTimeStampInserted=Wed May 04<br>", 
                "11:18:06 CDT 2016, mTimeStampMru=Wed May 04 11:18:06 CDT 2016]]<br>", 
                "<-- Elapsed: 0.102 sec: ImageInsertion (timer ImageInsertion)<br>", 
                "-- Elapsed: 0.103 sec: 1.3.12.2.1107.5.5.2.112186.4.0.20708479328063227 (timer DICOMIMAGE)<br>",
                 "<br><br>",
                 "<b>Status in the database before this step: </b> DICOMIMAGE",
                 "<br><br>",
                 "<b>Status in the database after this step: </b> POSTRECEPTION",
                 "<br><br>",
                 "<b>Database query:</b>select count(*),status from incoming_files where series_uid = '1.3.12.2.1107.5.5.2.112186.4.0.20708479328063227' group by 2,3;"],
    "postreception": [ "LDS creates the deferred activity.",
                  "<br><br>",
                  "<b>Log snippet:</b><br><br>",
                 "Processing 6 incoming files in the range (3956909,3956914) for status=POSTRECEPTION<br>",
                 "--> Start: 1.3.12.2.1107.5.5.2.112186.4.0.20708479328063227 (timer POSTRECEPTION)<br>",
                 "Destination class is [INT_AND_EXT] since pending validation is [false]<br>",
                 "Queueing UMDB update task<br>",
                 "Scheduled deferred activity with id=[13586987]: DeferredActivityData{Type=UmdbUpdate, Data={SeriesInstanceUid=1.3.12.2.1107.5.5.2.112186.4.0.20708479328063227, AeTitle=PLEXMISIAHMOD1, StudyInstanceUid=1.3.12.2.1107.5.5.2.112186.4.0.20708478832311392, PatientId=301286MIS}}<br>",
                 "Queueing J2c conversion task<br>",
                 "Scheduled deferred activity with id=[13589368]: DeferredActivityData{Type=J2CConversion, Data={SopInstanceUid=1.3.12.2.1107.5.5.2.112186.4.0.20712527121601061, SeriesPath=/usr/local/PACS/images/20160504/1.3.12.2.1107.5.5.2.112186.4.0.20708478832311392/1.3.12.2.1107.5.5.2.112186.4.0.20708479328063227}}<br>",
                 "Queueing Pending C-MOVE task<br>",
                 "Scheduled deferred activity with id=[13589369]: DeferredActivityData{Type=PendingCMove, Data={SeriesInstanceUid=1.3.12.2.1107.5.5.2.112186.4.0.20708479328063227, SopInstanceUid=1.3.12.2.1107.5.5.2.112186.4.0.20712527121601061}}<br>",
                 "Scheduled deferred activity with id=[13589370]: DeferredActivityData{Type=AutoRoute, Data={DoArchival=true, DestinationClass=INT_AND_EXT, SeriesInstanceUid=1.3.12.2.1107.5.5.2.112186.4.0.20708479328063227, SopInstanceUid=1.3.12.2.1107.5.5.2.112186.4.0.20712527121601061}}<br>",
                 "Elapsed for ifileid=[3956914]: 622 ms<br>",
                 "Queueing J2c conversion task<br>",
                 "Scheduled deferred activity with id=[13589371]: DeferredActivityData{Type=J2CConversion, Data={SopInstanceUid=1.3.12.2.1107.5.5.2.112186.4.0.20712525432003175, SeriesPath=/usr/local/PACS/images/20160504/1.3.12.2.1107.5.5.2.112186.4.0.20708478832311392/1.3.12.2.1107.5.5.2.112186.4.0.20708479328063227}}<br>",
                 "Queueing Pending C-MOVE task<br>",
                 "Scheduled deferred activity with id=[13589372]: DeferredActivityData{Type=PendingCMove, Data={SeriesInstanceUid=1.3.12.2.1107.5.5.2.112186.4.0.20708479328063227, SopInstanceUid=1.3.12.2.1107.5.5.2.112186.4.0.20712525432003175}}<br>",
                 "Scheduled deferred activity with id=[13589373]: DeferredActivityData{Type=AutoRoute, Data={DoArchival=true, DestinationClass=INT_AND_EXT, SeriesInstanceUid=1.3.12.2.1107.5.5.2.112186.4.0.20708479328063227, SopInstanceUid=1.3.12.2.1107.5.5.2.112186.4.0.20712525432003175}}<br>",
                 "Elapsed for ifileid=[3956913]: 883 ms<br>",
                 "Queueing J2c conversion task<br>",
                 "Scheduled deferred activity with id=[13589374]: DeferredActivityData{Type=J2CConversion, Data={SopInstanceUid=1.3.12.2.1107.5.5.2.112186.4.0.20712523622445513, SeriesPath=/usr/local/PACS/images/20160504/1.3.12.2.1107.5.5.2.112186.4.0.20708478832311392/1.3.12.2.1107.5.5.2.112186.4.0.20708479328063227}}<br>",
                 " . . . <br>",
                 "Queueing Pending C-MOVE task<br>",
                 "Scheduled deferred activity with id=[13589384]: DeferredActivityData{Type=PendingCMove, Data={SeriesInstanceUid=1.3.12.2.1107.5.5.2.112186.4.0.20708479328063227, SopInstanceUid=1.3.12.2.1107.5.5.2.112186.4.0.20712517931792141}}<br>",
                 "Scheduled deferred activity with id=[13589385]: DeferredActivityData{Type=AutoRoute, Data={DoArchival=true, DestinationClass=INT_AND_EXT, SeriesInstanceUid=1.3.12.2.1107.5.5.2.112186.4.0.20708479328063227, SopInstanceUid=1.3.12.2.1107.5.5.2.112186.4.0.20712517931792141}}<br>",
                 "Elapsed for ifileid=[3956909]: 2190 ms<br>",
                 "<-- Elapsed: 0.018 sec: 1.3.12.2.1107.5.5.2.112186.4.0.20708479328063227 (timer POSTRECEPTION)<br>",
                 "<br><br>",
                 "<b>Status in the database before this step: </b> POSTRECEPTION",
                 "<br><br>",
                 "<b>Status in the database after this step: </b> CLEANUP",
                 "<br><br>",
                 "<b>Database query:</b>select count(*),status from where series_uid = '1.3.12.2.1107.5.5.2.112186.4.0.20708479328063227' group by 2,3;"],
    "cleanup": [ "LDS deletes the temporary foldes and the rows from the incoming_files table.",
                  "<br><br>",
                  "<b>Log snippet:</b><br><br>",
                "Processing 6 incoming files in the range (3956909,3956914) for status=CLEANUP<br>",
                "--> Start: 1.3.12.2.1107.5.5.2.112186.4.0.20708479328063227 (timer CLEANUP)<br>",
                "Deleting files under /usr/local/PACS/images/tmp/incoming_files/20160504/1118/1.3.12.2.1107.5.5.2.112186.4.0.20712527121601061/1<br>",
                "Deleting row from incoming_files table with incoming_files_id=3956914<br>",
                "Deleting files under /usr/local/PACS/images/tmp/incoming_files/20160504/1118/1.3.12.2.1107.5.5.2.112186.4.0.20712525432003175/1<br>",
                "Deleting row from incoming_files table with incoming_files_id=3956913<br>",
                "Deleting files under /usr/local/PACS/images/tmp/incoming_files/20160504/1118/1.3.12.2.1107.5.5.2.112186.4.0.20712523622445513/1<br>",
                "Deleting row from incoming_files table with incoming_files_id=3956912<br>",
                "Deleting files under /usr/local/PACS/images/tmp/incoming_files/20160504/1118/1.3.12.2.1107.5.5.2.112186.4.0.20712521926882222/1<br>",
                "Deleting row from incoming_files table with incoming_files_id=3956911<br>",
                "Deleting files under /usr/local/PACS/images/tmp/incoming_files/20160504/1118/1.3.12.2.1107.5.5.2.112186.4.0.2071252024612713/1<br>",
                "Deleting row from incoming_files table with incoming_files_id=3956910<br>",
                "Deleting files under /usr/local/PACS/images/tmp/incoming_files/20160504/1118/1.3.12.2.1107.5.5.2.112186.4.0.20712517931792141/1<br>",
                "Deleting row from incoming_files table with incoming_files_id=3956909<br>",
                "<-- Elapsed: 0.0040 sec: 1.3.12.2.1107.5.5.2.112186.4.0.20708479328063227 (timer CLEANUP)<br>",
                "releasing lock [java.util.concurrent.locks.ReentrantLock@1ecf4c[Locked by thread com.intelerad.localdicomservice.databasequeues.IncomingFilesWorkerQueue_0]] for study [1.3.12.2.1107.5.5.2.112186.4.0.20708478832311392]<br>",
                "Removing study [1.3.12.2.1107.5.5.2.112186.4.0.20708478832311392] from list of studies queued<br>",
                 "<br><br>",
                 "<b>Status in the database before this step: </b> POSTRECEPTION"],

    "daw": [ "<b>LDS deferred activity workers</b><br>",
	     "<br><br>",
             "These workers are processing the deferred_activity tables and adding the deferred activities to different databases<br>",
             "<br><br>",
             "<b>Log files:<b><br><br>",
             "LocalDicomService_DeferredActivity_Cleanup.log<br>",
	     "LocalDicomService_DeferredActivity_UmdbSeriesDeleted.log<br>",
	     "LocalDicomService_DeferredActivity_RemoveSeriesArchive.log<br>",
	     "LocalDicomService_DeferredActivity_UmdbUpdate.log<br>",
	     "LocalDicomService_DeferredActivity_PendingCMove.log<br>",
	     "LocalDicomService_DeferredActivity_J2CConversion.log<br>",
	     "LocalDicomService_DeferredActivity_AutoRoute.log<br>",
	     "LocalDicomService_DeferredActivity_RemoveAutoRoute.log<br>",
	     "LocalDicomService_DeferredActivity_RemovePendingCMove.log<br>",
	     "LocalDicomService_DeferredActivity_StoreAndForward.log<br>",
	     "LocalDicomService_DeferredActivity_RemoveArchiveRequest.log<br>",
	     "LocalDicomService_DeferredActivity_SeriesMove.log<br>",
	     "LocalDicomService_DeferredActivity_UpdateSeriesArchive.log<br>",
	     "LocalDicomService_DeferredActivity_UmdbFailedSeriesUpdate.log<br>",
	     "LocalDicomService_DeferredActivity_RemoveSeriesMove.log<br>",
	     "LocalDicomService_DeferredActivity_RaiSeriesDeletionNotification.log<br>",
	     "LocalDicomService_DeferredActivity_MoveToSite.log<br>",
	     "LocalDicomService_DeferredActivity_DicomPrefetch.log<br>",
	     "LocalDicomService_DeferredActivity_DirectAutoRoute.log<br>"
           ],
    "databases": "<b>PACS databases involved in image flow</b>",
    "localdicom": [ "<b> Local dicom database</b><br><br>",
		  "<b>How to access:</b> psql-intelerad -D localdicom"
                  ],
    "incoming_files": [ "Contains the queue for the IFW threads<br><br>",
                       "<b>How to check the queue?</b> select count(*), status from incoming_files group by 2,3;</b>"
                     ],
    "deferred_activity": [ "Contains the information about each deferred_activity (sop/series uid etc) <br><br>",
                       "<b>How to check the queue?</b> select count(*), type,status from deferred_activity where status != 'Completed' group by 2,3;</b>"
                     ],
    "sop_todo": [ "List of the sops waiting to be converted to j2c <br><br>",
                       "<b>How to check the queue?</b> select count(*) from sop_todo;</b>"
                     ],
    "requests": [ "Contains the study checkpoints/corrections/deletions <br><br>",
                       "<b>How to check the queue?</b> select count(*),type,status from requests where status !='DONE' group by 2,3;</b>"
                     ],
    "image2brouted": [ "Contains the list of the SOPs waiting to be processed by do_auto_route and based on the routing rule set up on the server the SOPs will be added in AutoRoute. <br><br>",
                       "<b>Logs:</b> /var/log/PACS/do_auto_route/DO_AUTO_ROUTE.log<br><br>",
                       "<b>How to check the queue?</b> select count(*) from Image2BRouted</b>"
                     ],
    "autoroute": [ "Contains the list of the SOPs to be routed towards configureddestinations. <br><br>",
                       "<b>Logs:</b> /var/log/PACS/AutoRoute/child_AE.log<br><br>",
                       "<b>How to check the queue?</b> select count(*),dest_AE_title from AutoRoute group by dest_AE_title</b>"
                     ],
    "dcmroutedb": [ "Database for image routing <br><br>",
                       "Contains two tables: Image2BRuted and AutoRoute<br><br>",
                       "<b>How to access the database?</b> sqsh -D dcmRouteDB<br><br>",
                       "<b><i>Note: This database should _NEVER_ be grown!!!</b></i>"
                     ],
    "dicomworkqueuedb": [ "Database for the dicom workqueue waiting to update the master databases <br><br>",
                       "Contains one main table: UpdateMasterDbWorkQueue<br><br>",
                       "<b>How to access the database?</b> sqsh -D DicomWorkQueueDB<br><br>"
                     ],
    "updatemasterbbworkqueue": [ "Contains the list of the sop/series/studies waiting to update DicomMaster on the master database servers <br><br>",
                       "<b>How to check the queue:</b> run UpdateMasterDbQueueReport as admin"
                     ],

    "dicom_image": [ "Contains information about local DICOM data <br><br>",
                       "<b>How to access:</b> sqsh -D DicomImage"
                   ],
    "patientlevel": "Contains patient level information <br><br>",
                     
    "studylevel": "Contains study level information <br><br>",
                  
    "serieslevel": "Contains series level information <br><br>",
    "movereqdb": [ "<b>AutoMove and manual move queue </b><br><br>",
                       "Contains two tables: MovereqTable and PendingSopLog<br><br>",
                       "<b>How to access the database?</b> sqsh -D MoveReqDB<br><br>"
                     ],                   
    "movereqtable": [ "<b>AutoMove and manual move queue</b> <br><br>",
                       "Contains one main table: MovereqTable<br><br>",
                       "<b>How to access the queue?</b> select count(*) from MoveReqTable<br><br>"
                     ],
    "mdb_dms": [ "<b>Dicom Master Service</b><br><br>",
                       "<b>Logs:</b> /var/log/DicomMasterService<br><br>"
                     ],
    "dmsrp": [ "<b>Dicom Master Service Update Protocol</b><br><br>",
               "This thread is updating DicomMaster<br><br>",
                       "<b>Logs:</b> /var/log/PACS/DicomMasterService/DMS_DicomMasterUpdateProtocol*_hostname.log<br><br>"
             ],
   "dicommaster": [ "<b>Dicom Master database</b><br><br>",
               "Contains the list of all patient and dicom data from the PACS.<br><br>",
                       "<b>How to access the database?</b> sqsh -D DicomMaster<br><br>"
             ],
    "dicommaster_patientlevel": "Contains patient level information <br><br>",

    "dicommaster_studylevel": "Contains study level information <br><br>",

    "dicommaster_serieslevel": "Contains series level information <br><br>",
    "dicommaster_serieslocation": "Contains series location information <br><br>",


    "globaldicom": [ "Database that contains all the requests of IntelePACS <br><br>",
                       "<b>How to access the database?</b> psql-intelerad -D globaldicom<br><br>"
                     ],
    "umdb": [ "<b>Update Master Database</b><br><br>",
              "<b>Logs:</b> /var/log/PACS/UpdateMasterDb"
            ],
    "umdbw": [ "<b>Update Master DB workers</b> <br><br>",
               "These workers are responsible to push the update to Master database server DMS<br><br>",
               "We have one worker for each DicomMaster host",
               "<b>Log:</b> UPDATE_MASTER_DB_WORKER_MDB_fqdn.log"
             ],
    "rs":    [ "<b>Request synchronizer</b> <br><br>",
               "Pushing and pulling all request to/from global dicom<br><br>",
		"<b>Logs:</b>/var/log/PACS/LocalDicomService/LocalDicomService_REQUESTSYNCHRONIZER.log"
             ],


    "image_server":    [ "<b>Image server</b> <br><br>",
               "This service is performing the initial image ingestion<br><br>",
	       "<b>Logs:</b> /var/log/PACS/image_server<br><br>",
               "<b>Link to training slide:</b> <a href=\"https://docs.google.com/presentation/d/17S-ZF5E6H0hTW7NZUgabgVI2rnbc5JlJ-Qz74ZdIiYU/edit#slide=id.p39\"> Image Server training </a> <br><br>"

             ],
    "child_process": ["The child process will process the SOP and will add a the incoming file id to localdicom.incoming_files (the key was introduced in BZ46731<br><br>",
                      "By looking for that key in the IFW log files you will find the IFW working on that SOP<br><br>",
                      "<b>Log snippet:</b><br>",
                      "(storeDicomObject) successful insertion of image reference into localdicom.incoming_files ( file : /usr/local/PACS/images/dev4/tmp/incoming_files/20160210/1521/1.2.840.113619.2.116.6036616.1455088808.0.1484.4/1/1.2.840.113619.2.116.6036616.1455088808.0.1484.4.dcm; key : 9380954 )"

                     ],
    "locationsdb": "This is the new Series Location database (4-12-1 and up). Basically this database is the copy of the old DicomMaster/SeriesLocation",
    "locations": "Contains series location information <br><br>",
    "updatemasterdbworkqueue" : ["Contains the UMDB queue",
                                 "<br><br>",
                                 "<b>How to check UMDB queue:</b> run UpdateMasterDbQueueReport as admin"
                                ]
}
